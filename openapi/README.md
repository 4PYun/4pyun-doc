# 开放平台文档

该部分内容供有云平台研发能力的公司做接口接入，平台开放基础服务能力包括但不限于:

- 聚合支付
- 电子发票
- 广告联盟
- 停车业务

等功能。

您可联系平台商务获得技术以及商务政策信息，平台将安排专人协助完成功能接入。


#### 1.1 公共参数

| 字段       | 说明                                | 示例                             |
| :--------- | :---------------------------------- | :------------------------------- |
| app_id     | 应用ID, 由P云平台分配               | op12defadfad                     |
| timestamp  | 当前请求时间戳, 单位毫秒            | 1570318158852                    |
| sign       | 签名数据，具体规则见签名算法        | 1A6FE20BDD05B654F8FD33A299D75DF3 |
| sign_type  | 签名算法                            | MD5                              |


#### 1.2 签名算法

**算法执行步骤**

1. 设所有发送或接收到的数据为集合M，将集合M内非空参数值的参数按照参数名 `ASCII码` 从小到大排序（字典序），使用 `URL键值对` 的格式（即 `key1=value1&key2=value2...`）拼接成字符串 `stringA`。
2. `sign = stringA + "&app_secret=" + appSecret`，取 `MD5`（`32位不区分大小写`）。

**注意事项**

1. 参数名 ASCII码 从小到大排序（字典序）；
2. 如果参数值为空（即null或空字符串）不参与签名；
3. 参数名区分大小写；
4. 验证签名时，sign 参数不参与签名，将生成的签名与该 sign 值作校验；
5. 接口可能增加字段，验证签名时必须支持增加的扩展字段；

**示例**

**密钥：**

| 字段       | 示例值                           |
| ---------- | -------------------------------- |
| app_id     | op88641899bd20661                |
| app_secret | 29b72e85f56f9d20b2303d5289fe78c9 |

**输入参数：**

| 字段       | 示例值                               |
| ---------- | ------------------------------------ |
| park_uuid  | 40e06b24-7320-4a61-8d97-7ebccb364a87 |
| plate      | 粤B660PP                             |
| car_type   | 1                                    |
| enter_time | 1563242533431                        |

**计算 sign 的过程如下：**

1. 参数排序后字符串拼接：
```
app_id=op88641899bd20661&car_type=1&enter_time=1563242533431&park_uuid=40e06b24-7320-4a61-8d97-7ebccb364a87&plate=粤B660PP&sign_type=MD5&timestamp=1563242932357&app_secret=29b72e85f56f9d20b2303d5289fe78c9
```

2. 使用 MD5 （32位不区分大小写）加密：
```
1A6FE20BDD05B654F8FD33A299D75DF3
```
